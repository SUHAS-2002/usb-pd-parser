Universal Serial Bus Power Delivery Specification, Revision 3.2, Version 1.1, 2024-10
Page 117
The Extended field Shall apply to all SOP* Packet types.
6.2.1.1.2
  Number of Data Objects
When the Extended field is set to zero the 3-bit Number of Data Objects field Shall indicate the number of 32-bit 
Data Objects that follow the Message Header. When this field is zero the Message is a Control Message and when it 
is non-zero, the Message is a Data Message.
The Number of Data Objects field Shall apply to all SOP* Packet types.
When both the Extended bit and Chunked bit are set to one, the Number of Data Objects field Shall indicate the 
number of Data Objects in the Message padded to the 4-byte boundary including the Extended Message Header as 
part of the first Data Object. 
When the Extended bit is set to one and Chunked bit is set to zero, the Number of Data Objects field Shall be 
Reserved.
Note:
In this case, the Message length is determined solely by the Data Size field in the Extended Message 
Header.
6.2.1.1.3
  MessageID
The 3-bit MessageID field is the value generated by a rolling counter maintained by the originator of the Message. 
The MessageIDCounter Shall be initialized to zero at power-on as a result of a Soft Reset, or a Hard Reset. The 
MessageIDCounter Shall be incremented when a Message is successfully received as indicated by receipt of a 
GoodCRC Message.
Note:
The usage of MessageID during testing with BIST Messages is defined in [USBPDCompliance].
The MessageID field Shall apply to all SOP* Packet types.
6.2.1.1.4
  Port Power Role
The 1-bit Port Power Role field Shall indicate the Port's present Power Role:

0b Sink

1b Source
Messages, such as Get_Sink_Cap_Extended, that are only ever sent by a Source, Shall always have the Port Power 
Role field set to Source. Similarly, Messages such as the Request Message that are only ever sent by a Sink Shall 
always have the Port Power Role field set to Sink.
During the Power Role Swap AMS, for the Initial Source Port, the Port Power Role field Shall be set to Sink in the 
PS_RDY Message indicating that the Initial Source's power supply is turned off (see Table 8.60, "Steps for a 
Successful Source Initiated Power Role Swap Sequence" and Table 8.63, "Steps for a Successful Sink Initiated Power 
Role Swap Sequence").
During the Power Role Swap AMS, for the Initial Sink, the Port Power Role field Shall be set to Source for Messages 
initiated by the Policy Engine after receiving the PS_RDY Message from the Initial Source (see Table 8.60, "Steps for 
a Successful Source Initiated Power Role Swap Sequence" and Table 8.63, "Steps for a Successful Sink Initiated Power 
Role Swap Sequence").
During the Fast Role Swap AMS, for the Initial Source Port, the Port Power Role field Shall be set to Sink in the 
PS_RDY Message indicating that VBUS is not being driven by the Initial Source and is within vSafe5V (see Figure 8.39, 
"Successful Fast Role Swap Sequence").
During the Fast Role Swap AMS, for the Initial Sink Port, the Port Power Role field Shall be set to Source for 
Messages initiated by the Policy Engine after receiving the PS_RDY Message from the Initial Source (see Figure 8.39, 
"Successful Fast Role Swap Sequence"). 
Note:
The GoodCRC Message sent by the Initial Sink in response to the PS_RDY Message from the Initial Source 
will have its Port Power Role field set to Sink since this is initiated by the Protocol Layer. Subsequent 
